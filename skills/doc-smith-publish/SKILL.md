---
name: doc-smith-publish
description: 将 Doc-Smith 生成的文档发布到在线平台。当用户要求发布文档、上线、部署文档时使用此技能。
---

# Doc-Smith 文档发布

将生成的文档发布到在线平台。

## 触发场景

- 用户要求发布文档
- 用户说"发布"、"上线"、"部署文档"

## 工作流程

### 1. 检测 Workspace

检查当前目录是否为有效的 Doc-Smith workspace：

```bash
ls -la config.yaml planning/document-structure.yaml docs/
```

### 2. 检查发布条件

调用 `doc-smith-check` 确保文档完整：
- 文档结构校验通过
- 文档内容检查通过
- 必需的文档都已生成

如果检查失败，提示用户先修复问题。

### 3. 确认发布目标

**读取已有配置：**
从 `config.yaml` 读取 `appUrl`（上次发布的目标）

**确认或更新目标：**
- 如果用户提供了新的 URL，使用新 URL
- 如果未提供且有历史记录，询问是否使用上次的目标
- 如果都没有，要求用户提供发布目标 URL

### 4. 检查授权

检查是否有有效的站点授权（存储在系统 keyring 中）。

如果没有授权：
1. 提示用户需要授权
2. 引导用户完成授权流程
3. 保存授权信息

### 5. 翻译 Meta 信息

确保文档的 meta 信息（标题、描述）已翻译到所有目标语言。

### 6. 执行发布

调用发布脚本上传文档。

**执行方式：**

```bash
node skills/doc-smith-publish/scripts/publish-docs.mjs
```

### 7. 保存发布信息

更新 `config.yaml`：
- `appUrl`: 发布目标 URL

### 8. 返回结果

返回发布结果：
- 发布状态（成功/失败）
- 发布的文档数量
- 在线访问 URL

## 参数

- `appUrl`: 发布目标 URL（可选，优先使用历史记录）

## 错误处理

- **授权失败**：引导用户重新授权
- **网络错误**：提示重试
- **文档不完整**：提示先完成文档生成
