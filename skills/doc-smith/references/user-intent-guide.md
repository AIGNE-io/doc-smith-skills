# 用户意图推断指南

**文件位置**: `.aigne/doc-smith/intent/user-intent.md`
**权限**: 仅在用户确认后写入，AI 可起草但不可直接修改

本文档提供如何推断和生成用户意图的详细指南。

## 推断内容

基于工作区内容推断以下三个方面：

### 1. 目标用户

判断文档的主要受众（技术开发者、最终用户、运维人员、产品经理等）。

### 2. 主要使用场景

推断用户查阅文档的场景（首次接触、开发集成、问题排查、深入学习等）。

### 3. 文档侧重点

确定文档类型（使用指南型、参考手册型、快速上手型、架构说明型）。

## user-intent.md 模板

```markdown
# 用户意图

## 目标用户
[描述主要受众是谁，需要什么类型的信息]

## 使用场景
- [场景 1：用户在什么情况下查阅文档]
- [场景 2：...]
- [场景 3：...]

## 文档侧重点
本文档采用**[文档类型]**的形式：
- [侧重点 1]
- [侧重点 2]
- [侧重点 3]

[可选：说明不需要的内容，帮助聚焦]
```

## 示例

```markdown
# 用户意图

## 目标用户
本文档主要面向希望集成本项目 API 的开发者。

## 使用场景
- 开发者首次接触项目时，需要快速了解核心功能和如何开始
- 开发过程中查阅具体 API 的使用方法和参数说明

## 文档侧重点
本文档采用**使用指南 + API 参考**的组合形式：
- 提供清晰的快速开始指南
- 提供完整的 API 参考文档

不需要过多的架构设计说明。
```

## 交互策略

### 默认流程

1. **自动生成**：基于工作区分析，自动推断用户意图并生成 user-intent.md
2. **展示意图**：向用户展示推断的完整意图
3. **使用 AskUserQuestion 工具确认**：
   - 问题："用户意图是否符合您的需求？"
   - 选项："✅ 确认，开始规划文档结构"
4. **接收反馈**：如果用户选择调整或通过 Other 提供具体需求，更新 user-intent.md
5. **重新展示**：展示更新后的完整意图
6. **循环确认**：重复步骤 3-5，直到用户确认
7. **进入下一步**：用户确认后，才开始规划文档结构

### 展示格式

向用户展示推断的意图时，应清晰展示三个部分：

```
📝 用户意图推断

## 目标用户
[具体描述]

## 使用场景
- [场景 1]
- [场景 2]
- [场景 3]

## 文档侧重点
本文档采用**[文档类型]**的形式：
- [侧重点 1]
- [侧重点 2]

[可选：不需要的内容]

这个意图是否符合您的需求？您可以提出调整建议。
```

### 示例交互

```
Agent: 📝 用户意图推断

## 目标用户
本文档主要面向希望集成本项目 API 的开发者。

## 使用场景
- 开发者首次接触项目时，需要快速了解核心功能
- 开发过程中查阅具体 API 的使用方法

## 文档侧重点
本文档采用**使用指南 + API 参考**的组合形式：
- 提供清晰的快速开始指南
- 提供完整的 API 参考文档

---

[Agent 使用 AskUserQuestion 工具]
问题：用户意图是否符合您的需求？
选项：✅ 确认，开始规划文档结构

---

User: [选择 ✏️ Other] 其实主要是给运维人员看的，重点是部署和配置说明

---

Agent: 已更新目标用户和文档侧重点。

📝 更新后的用户意图

## 目标用户
本文档主要面向需要部署和维护系统的运维人员。

## 使用场景
- 运维人员首次部署时，需要了解系统要求和部署步骤
- 日常维护中查阅配置选项和最佳实践

## 文档侧重点
本文档采用**运维指南**的形式：
- 提供详细的部署和配置说明
- 提供系统要求和环境配置指南

---

[Agent 使用 AskUserQuestion 工具]
问题：用户意图是否符合您的需求？
选项：✅ 确认，开始规划文档结构

---

User: ✅ 确认，开始规划文档结构

---

Agent: 收到确认，开始规划文档结构...
```

### 处理反馈

根据用户反馈更新 user-intent.md 的对应部分（目标用户、使用场景、文档侧重点），必要时完全重写。每次修改后必须重新展示完整意图并询问确认。

## 关键原则

1. **基于证据推断**：从工作区内容（代码结构、README、配置文件）中寻找线索
2. **保持简洁**：user-intent.md 应该简洁明了，避免冗长
3. **可修改性**：用自然语言编写，用户易于理解和调整
4. **多轮确认**：支持用户多轮调整，每次修改后重新展示完整意图并确认
5. **用户确认后才继续**：绝对不要在用户确认前开始规划文档结构
