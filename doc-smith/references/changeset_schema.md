# Changeset 文件理解指南

## 核心原则

Changeset 只包含两类修改：
1. **全局语义修改** - 跨文档的规则、术语、风格
2. **结构重写** - 补充、重写、重组特定章节

**注意：** PATCH 类修改通过文档内 `:::PATCH` 标记实现，不会出现在 changeset 中。

## 读取和理解

Changeset 是自然语言文本，格式自由。你需要：
1. 读取文件全部内容
2. 识别所有修改请求
3. 分类为"全局修改"或"结构重写"
4. 按优先级执行：全局修改 → 结构重写

## 识别规则

### 全局修改特征
- 关键词："所有"、"统一"、"全部"、"删除"
- 跨多个文档的规则
- 术语、风格、格式的一致性

**示例：**
```
"所有 API 改为 API 接口"         → 全局修改
"删除所有第一人称"               → 全局修改
"代码块统一添加语言标识符"       → 全局修改
```

### 结构重写特征
- 关键词："补充"、"添加"、"重写"、"重组"
- 指定文档或章节
- 需要生成新内容

**示例：**
```
"overview.md 补充项目背景"       → 结构重写
"快速开始添加环境要求章节"       → 结构重写
"API 文档补充错误码说明"         → 结构重写
```

## 常见模式参考

### 模式 1：简单列表
```markdown
1. 统一术语："API" → "API 接口"
2. 补充 overview.md 的项目背景
3. 删除所有形容词
```

理解：1, 3 是全局修改；2 是结构重写

### 模式 2：分类组织
```markdown
## 全局修改
- 代码示例添加语言标识符
- 禁止使用第一人称

## 补充内容
- getting-started.md 添加环境要求
- api/errors.md 补充错误原因
```

理解：按章节分类，直接识别

### 模式 3：自由描述
```markdown
发现文档问题：
- "API" 和 "接口" 混用，统一为 "API 接口"
- 快速开始缺环境要求说明
```

理解：第一条是全局修改，第二条是结构重写

## 执行流程

### 1. 读取文件
```bash
cat <changeset-file-path>
```

### 2. 分类汇总

**全局修改：**
- 规则 1: ...
- 规则 2: ...

**结构重写：**
- 文档 A, 章节 X: ...
- 文档 B, 章节 Y: ...

### 3. 执行修改

**优先级：** 全局修改 → 结构重写

**全局修改：**
```bash
find .aigne/doc-smith/docs/ -name "*.md"
```
遍历所有文档，应用规则

**结构重写：**
定位章节，读取上下文，重新生成内容

### 4. 展示摘要

列出所有执行的修改和受影响的文件

## 处理歧义

**模糊描述：** 询问用户具体要求

**范围不明：** 先搜索确定影响范围，再执行

**冲突规则：** 说明冲突，询问优先级
