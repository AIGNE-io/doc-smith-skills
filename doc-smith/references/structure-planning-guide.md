# 文档结构规划指南

**文件位置**: `planning/document-structure.yaml`
**权限**: AI 可重写/更新，可重算

本文档提供如何规划文档结构和决定是否拆分的详细指南。

## 核心原则

**规划必须依据用户意图**

在规划文档结构时，持续参考 `intent/user-intent.md` 中的内容：
- **目标用户决定文档类型**：技术开发者需要 API 参考，最终用户需要使用指南
- **使用场景决定文档范围**：快速上手只需核心功能，深入学习才需要完整架构
- **侧重点决定详细程度**：使用指南型文档重实践轻原理，参考手册型文档要全面覆盖

## 常见问题及避免方法

### ❌ 不看用户意图，直接按代码结构规划

导致文档大而全，不聚焦用户需求。应该先参考 intent/user-intent.md，只为用户需要的模块创建文档。

### ❌ 规划了用户不需要的文档

浪费资源生成无用文档。应该严格按照 intent/user-intent.md 中的"文档侧重点"规划。

### ❌ 文档粒度与用户需求不匹配

顺序任务应合并成单一文档，独立模块才考虑拆分。

## 规划策略

### 1. 最小必要原则

只规划用户意图中明确需要的文档。

**检查清单**：
- [ ] 这个文档是否在 intent/user-intent.md 的使用场景中？
- [ ] 这个文档是否符合文档侧重点？
- [ ] 如果去掉这个文档，用户会缺失重要信息吗？

### 2. 聚焦核心场景

优先覆盖用户的主要使用场景。

**优先级排序**：
1. intent/user-intent.md 中明确提到的场景
2. 对目标用户最重要的功能
3. 可选的高级特性

### 3. 适度深度

根据用户需求决定嵌套层级。

**深度指南**：
- 最终用户：扁平结构（1 层）
- 开发者：适度嵌套（1-2 层）
- 复杂系统：合理嵌套（2-3 层）

## 拆分判断标准

### 应该拆分为子文档

**必须满足以下 3-4 个条件**：

1. **内容量大**
   - 父主题包含 4 个以上主要章节
   - 单页阅读体验差（预计超过 500 行）

2. **独立性强**
   - 每个子主题都有丰富的独立内容
   - 至少 3 个段落或 3+ 小节
   - 可以独立理解，不强依赖其他子主题

3. **无重复**
   - 子文档之间没有明显内容重复
   - 子文档与父文档之间没有明显内容重复

4. **独立查阅**
   - 用户经常需要单独查阅某个子主题
   - 而非顺序通读全部内容

**示例：应该拆分**

API 参考拆分为用户、订单、支付三个子文档，因为每个类别内容丰富、相对独立、开发者会单独查阅。

### 不应该拆分

**有以下任一情况**：

1. **子文档内容单薄**
   - 预计少于 3 段内容
   - 没有足够的源文件支持

2. **存在内容重复或相互依赖**
   - 子文档之间有明显的内容重复
   - 必须同时阅读多个子文档才能理解

3. **顺序完成的步骤**
   - 用户需要按顺序完成所有步骤
   - 如：安装 → 配置 → 首次运行

4. **拆分后父文档变空壳**
   - 父文档只剩导航链接
   - 没有实质内容

**示例：不应该拆分**

快速开始不应拆分为安装、配置、首次运行三个子文档，因为这是顺序步骤，用户需要连续完成，拆分反而增加导航负担。应该合并为单一文档。

## 结构评估清单

在创建 document-structure.yaml 之前，对每个可能的嵌套结构使用此清单：

### 支持拆分的信号

满足 3+ 个时考虑拆分：

- [ ] 父主题源文件内容丰富，预计生成 4+ 个主要章节
- [ ] 每个子主题都有足够的源文件和独立内容（预计 3 段或 3+ 小节）
- [ ] 子主题之间相对独立，用户可能单独查阅（如不同的 API 类别）
- [ ] 工作区中已有按模块组织的源文件结构

### 反对拆分的信号

有 2+ 个时保持扁平：

- [ ] 子主题源文件内容单薄，预计每个少于 3 段
- [ ] 子主题之间有明显的顺序依赖或内容重复
- [ ] 用户需要按顺序完成（如安装 → 配置 → 首次运行）
- [ ] 源文件没有明确的模块划分

### 决策

综合评估后选择最适合用户的结构。

## 平衡原则

**优先考虑用户体验，根据实际内容量和用户需求决定结构。**

当难以决定时，问自己：
1. 这个结构对用户友好吗？
2. 用户能快速找到需要的信息吗？
3. 是否有不必要的导航层级？

**经验法则**：
- 有疑虑时，选择更简单的结构
- 扁平优于嵌套
- 少即是多
